apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Override namespace
namespace: harbor-operator-ns

# Common annotations
commonAnnotations:
  goharbor.io/deploy-engine: Kustomization
  goharbor.io/deploy-mode: cluster
  goharbor.io/operator-version: v1.1.0

# All the referred deployment manifests
# NOTES: when doing changes to the ref versions, please also do same changes in the patch/annotation.yaml file
resources:
- ../../config/default
- patch/namespace.yaml
- https://raw.githubusercontent.com/spotahome/redis-operator/master/example/operator/all-redis-operator-resources.yaml?ref=v1.0.0
- github.com/zalando/postgres-operator/manifests?ref=v1.5.0
- github.com/minio/operator?ref=v4.0.6

# If you have to override the image source, uncomment this patch and also change the image source in the patch/image-source.yaml file.
# Then rebuild.
#   - patch/image-source.yaml
patchesStrategicMerge:
- patch/delete-minio-console.yaml
- patch/delete-duplicated-ns.yaml
- patch/pg-configmap.yaml

patchesJson6902:
- path: patch/annotations.yaml
  target:
    group: apps
    kind: Deployment
    name: harbor-operator
    version: v1

images:
- name: goharbor/harbor-operator
  newName: heww/harbor-operator
  newTag: dev
- name: minio/console
  newName: ghcr.io/goharbor/minio-console
- name: minio/operator
  newName: ghcr.io/goharbor/minio-operator
- name: quay.io/spotahome/redis-operator
  newName: ghcr.io/goharbor/redis-operator
  newTag: v1.0.0
- name: registry.opensource.zalan.do/acid/postgres-operator
  newName: ghcr.io/goharbor/postgres-operator
